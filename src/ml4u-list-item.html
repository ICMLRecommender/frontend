<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-item/paper-icon-item.html">
<link rel="import" href="../bower_components/paper-item/paper-item-body.html">

<dom-module id="ml4u-list-item">
  <template>
    <style>
    paper-item {
      border-left-style: solid;
      border-left-width: 7px;
      border-bottom-style: solid;
      border-bottom-width: 1px;
      border-bottom-color: #D0D0D0;
    }
    paper-item.child {
      border-left-width: 17px;
    }
    paper-item.break {
      border-left-color: #4990E2;
    }
    span.sessiontype {
      color: white;
      font-size: 12px;
      padding-left: 5px;
      padding-right: 5px;
      border-radius:3px 3px 3px 3px;  //rounds corners for other browsers
      -moz-border-radius:3px 3px 3px 3px;  // rounds corners for firefox
    }
    span.sessiontype:first-letter {
      text-transform: uppercase;
    }
    span.break {
      background-color: #4990E2;
    }
    paper-item.tutorial {
      border-left-color: #f3d4db;
    }
    span.tutorial {
      background-color: #f3d4db;
    }
    paper-item.session {
      border-left-color: black;
    }
    span.session {
      background-color: black;
    }
    paper-item.poster {
      border-left-color: #00CC99;
    }
    span.poster {
      background-color: #00CC99;
    }
    paper-item.invited.talk {
      border-left-color: #b8cefe;
    }
    span.invited.talk {
      background-color: #b8cefe;
    }
    paper-item.oral {
      border-left-color: #fcb168;
    }
    span.oral {
      background-color: #fcb168;
    }
    paper-item.spotlight {
      border-left-color: #df8095;
    }
    span.spotlight {
      background-color: #df8095;
    }
    paper-item.demonstration {
      border-left-color: #b7b2ed;
    }
    span.demonstration {
      background-color: #b7b2ed;
    }
    paper-item.symposium {
      border-left-color: #60F0F0;
    }
    span.symposium {
      background-color: #60F0F0;
    }
    paper-item.workshop {
      border-left-color: #fd9edf;
    }
    span.workshop {
      background-color: #fd9edf;
    }

    paper-item.paper {
      border-left-color: #BC0000;
    }
    span.paper {
      background-color: #BC0000;
    }

    iron-icon {
      color:black;
    }
    iron-icon.favourite {
      color:GoldenRod;
    }
    /*.author {
      width: 2px;
      background-color:pink;
    }*/
    iron-icon.author {
      width:100%;
      height:100%;
    }
    #authorsString {
      display:inline-block;
      max-width: 80%;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    </style>

    <template is="dom-if" if="{{isPaper}}">
      <paper-item class="paper"  on-tap="_changeSelectedItem">
        <paper-item-body three-line>
          <div secondary>
            <span>{{listItem.session_time}}<span>
            <span style="float:right" class="paper sessiontype">Paper</span><br/>
          </div>
          <div>{{listItem.title}}</div>
          <div secondary><span id="authorsString">{{listItem.authorsString}}</span><span style="float:right" hidden$="true"><iron-icon style="float:right; color:#D0011B; display:[[isFavouriteDisplay]];" icon="icons:bookmark" class$="{{favouriteClass}}"></iron-icon></span></div>
        </paper-item-body>
      </paper-item>
    </template>

    <template is="dom-if" if="{{!isPaper}}">
      <paper-item class$="{{listItem.type}}"  on-tap="_changeSelectedItem">
        <paper-item-body three-line>
          <div secondary>
            <span>{{listItem.session_time_string}} &bull; {{listItem.session_location}}<span>
            <span style="float:right" class$="{{listItem.type}} sessiontype">{{listItem.type}}</span><br/>
          </div>
          <div>{{listItem.session_title}}</div>
          <div secondary>Chair: {{listItem.session_chair}}</div>
        </paper-item-body>
      </paper-item>
    </template>
  </template>
  <script>
    Polymer({
      is: 'ml4u-list-item',
      properties: {
        listItem: Object,
        isPaper: {
          type: Boolean,
          value: false
        },
        selectedItem: {
          type: String,
          notify: true
        },

        /*
        <span hidden$="true"><iron-icon style="float:right; color:#D0011B; display:[[isFavouriteDisplay]];" icon="icons:bookmark" class$="{{favouriteClass}}"></iron-icon></span>
        profile: {
          type: Object,
          notify: true
        },
        favouriteClass: String,
        isFavouriteDisplay: {
          type: String,
          value: 'none'
        },*/

      },
        ready: function() {
          //if(this.listItem.itemId in this.profile.favourites) {
          //  this.favouriteClass = "favourite";
          //}
        //console.log("the following item used:1");
        //console.log(this.listItem);
      },
      //This is used once the favourite state is changed, not when this element is created.
      setFavourite(isFavourite) {
        this.favouriteClass = isFavourite ? "favourite" : "";
        this.isFavourite = isFavourite;
      },
      _changeSelectedItem: function(event, d, s) {
        console.log("_changeSelectedItem");
        if(this.listItem.session_id == undefined)
          return;
        console.log("1");
        if(this.isPaper) {
          this.selectedItem = this.listItem.id;
          console.log("2");
          console.log(this.selectedItem);
        }
        else {
          this.selectedItem = this.listItem.session_id;
          console.log("3");
          console.log(this.selectedItem);
        }
      }
});

  </script>
</dom-module>
