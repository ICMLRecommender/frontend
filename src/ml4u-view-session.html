<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="ml4u-list.html">

<dom-module id="ml4u-view-session">

<style is="custom-style">
:host {
}

section.itemViewHeader {
  color: white;
  background-color: var(--app-primary-color);
  padding: 5px;
  font-weight: bold;
  font-size: 20px;
}

#sessionInfo {
  padding: 14px 30px 14px 30px;
  background: #FAFAFA;
  box-shadow: 0 1px 3px 0 rgba(0,0,0,0.35);
}
.timeandloc {
  font-size: 16px;
  color: #989898;
}
span.loc {
  float: right;
}
.sessionTitle {
  font-size: 23px;
  color: #4A4A4A;
  margin: 10px 0px 10px 0px;
}
.bottomSessionInfo {
  font-size: 16px;
}
#papersDiv {
  margin-top: 1px;
}

</style>
<template>
  <section class="itemViewHeader">
    <paper-icon-button dialog-confirm icon="icons:close"></paper-icon-button>
    <span>Session</span>
  </section>
  <section class="container">
    <div id="sessionInfo">
      <div class="timeandloc"><span>{{session.session_time_string}}</span><span class="loc">{{session.session_location}}</span></div>
      <div class="sessionTitle">{{session.session_title}}</div>
      <div class="bottomSessionInfo"><span style="color: #989898;">Chair: </span><span style="color: #000000;">{{session.session_chair}}</span></div>
    </div>
    <div id="papersDiv">
      <ml4u-list items="[[papers]]"
          selected-item={{selectedPaper}} id-prefix="sched" is-paper-list></ml4u-list>
    </div>
  </section>
</template>

<script>
  Polymer({
    is: 'ml4u-view-session',
    properties: {
      sessionId: String,
      session: {
        type: Object,
        computed: '_computeSession(sessionId)'
      },
      papers: {
        type: Object,
        computed: '_computePapersList(sessionId)'
      },
      selectedPaper: {
        type: String,
        notify: true
      },
      needsReload: {
        type: Number,
        notify: true,
        value: 0
      }
    },
    _computeSession: function(sessionId) {
      console.log("hello from _computeSession, where sessionId is:");
      console.log(sessionId);
      if(sessionId == undefined || sessionId=="") {
        return {};
      }
      if(window.ml4u == undefined || window.ml4u.sharedElements == undefined
        || window.ml4u.sharedElements.scheduleDataProvider == undefined) {
        //postpone the reloading for later.
        this.needsReload = 1;
        return {};
      }
      session = window.ml4u.sharedElements.scheduleDataProvider.getSession(sessionId);
      return session;
    },
    _computePapersList: function(sessionId) {
      if(sessionId == undefined || sessionId=="") {
        return [];
      }
      if(window.ml4u == undefined || window.ml4u.sharedElements == undefined
        || window.ml4u.sharedElements.scheduleDataProvider == undefined) {
        //postpone the reloading for later.
        this.needsReload = 1;
        return [];
      }
      papers = window.ml4u.sharedElements.scheduleDataProvider.getSessionItems(sessionId);
      return papers;
    }

  });
  </script>
</dom-module>
